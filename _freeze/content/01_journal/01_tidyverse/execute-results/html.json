{
  "hash": "993fec6c859d5e150401df4aefcd5c46",
  "result": {
    "markdown": "---\ntitle: \"Tidyverse\"\nauthor: \"Gurukiran Ravi\"\n---\n\n\n# Challenge 1\n\n\n::: {.cell hash='01_tidyverse_cache/html/unnamed-chunk-1_33057efbeb5c3dd4d5cc3769d7b35a53'}\n\n```{.r .cell-code}\n# 1.0 Load libraries ----\nsuppressWarnings({\n  library(tidyverse)\n  library(readxl)\n  library(lubridate)\n})\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n#> ✔ dplyr     1.1.2     ✔ readr     2.1.4\n#> ✔ forcats   1.0.0     ✔ stringr   1.5.0\n#> ✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n#> ✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n#> ✔ purrr     1.0.1     \n#> ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n#> ✖ dplyr::filter() masks stats::filter()\n#> ✖ dplyr::lag()    masks stats::lag()\n#> ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\nbike_orderlines_wrangled_tbl <- read_excel(path = \"C:\\\\Users\\\\Admin\\\\Documents\\\\GitHub\\\\ss23-bdsb-Gurukiran4\\\\bike_data_main\\\\bike_orderlines.xlsx\")\n\n#challenge_tidyverse_1\nnew_tbl <- bike_orderlines_wrangled_tbl %>%\n  \n  #Select Columns\n  select(location, total_price) %>%\n  \n  #Separate city and state\n  separate(location, into = c(\"city\", \"state\"), sep = \", \",remove = TRUE)  %>%\n  \n  #Group states and sales\n  group_by(state) %>%\n  summarise(sales = sum(total_price)) %>%\n  ungroup() %>%\n  \n  # Format $ Text\n  mutate(sales_text = scales::dollar(sales, big.mark = \".\", \n                                     decimal.mark = \",\", \n                                     prefix = \"\", \n                                     suffix = \" €\"))\n\nnew_tbl %>%\n  \n  # Setup canvas with the columns year (x-axis) and sales (y-axis)\n  ggplot(aes(x = state, y = sales)) +\n  \n  # Geometries\n  geom_col(fill = \"#2DC6D6\") + # Use geom_col for a bar plot\n  geom_label(aes(label = sales_text)) + # Adding labels to the bars\n  geom_smooth(method = \"lm\", se = FALSE) + # Adding a trendline\n  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +\n  # Formatting\n  # scale_y_continuous(labels = scales::dollar) + # Change the y-axis. \n  # Again, we have to adjust it for euro values\n  scale_y_continuous(labels = scales::dollar_format(big.mark = \".\", \n                                                    decimal.mark = \",\", \n                                                    prefix = \"\", \n                                                    suffix = \" €\")) +\n  labs(\n    title    = \"Revenue by state\",\n    subtitle = \"\",\n    x = \"State\",\n    y = \"Revenue\"\n  )\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> `geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](01_tidyverse_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n### Which state has the highest revenue?\n\nIt can be noted from the graph that **\"North Rhine-Westphalia\"** has the highest revenue.\n\n# Challenge 2\n\n## Analyze the sales by location and year. \n\n\n::: {.cell hash='01_tidyverse_cache/html/unnamed-chunk-2_d4baeeb581f208788e57fe0c0e27480a'}\n\n```{.r .cell-code}\n#challenge_tidyverse_2\nnew_tbl2 <- bike_orderlines_wrangled_tbl %>%\n  \n  # Select columns and add a year\n  select(order_date, location, total_price) %>%\n  separate(location, into = c(\"city\", \"state\"), sep = \", \",remove = TRUE)  %>%\n  mutate(year = year(order_date)) %>%\n  \n  # Group by and summarize year and main category\n  group_by(year, state) %>%\n  summarise(sales = sum(total_price)) %>%\n  ungroup() %>%\n  \n  # Format $ Text\n  mutate(sales_text = scales::dollar(sales, big.mark = \".\", \n                                     decimal.mark = \",\", \n                                     prefix = \"\", \n                                     suffix = \" €\"))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> `summarise()` has grouped output by 'year'. You can override using the\n#> `.groups` argument.\n```\n:::\n\n```{.r .cell-code}\nnew_tbl2 %>%\n  \n  # Set up x, y, fill\n  ggplot(aes(x = year, y = sales, fill = state)) +\n  \n  # Geometries\n  geom_col() + # Run up to here to get a stacked bar plot\n  geom_smooth(method = \"lm\", se = FALSE) + #trendline\n  # Facet\n  facet_wrap(~ state) +\n  \n  # Formatting\n  scale_y_continuous(labels = scales::dollar_format(big.mark = \".\", \n                                                    decimal.mark = \",\", \n                                                    prefix = \"\", \n                                                    suffix = \" €\")) +\n  labs(\n    title = \"Revenue by year and state\",\n    subtitle = \"\",\n    fill = \"State\" # Changes the legend name\n  )\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> `geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](01_tidyverse_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}